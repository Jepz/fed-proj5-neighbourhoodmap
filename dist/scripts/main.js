function initMap(){"use strict";map=new google.maps.Map(document.getElementById("map"),{center:{lat:59.314726,lng:18.072188},scrollwheel:!1,styles:styles,zoom:15}),ko.applyBindings(new ViewModel)}var map,infoWindow,Location=function(o){"use strict";this.title=o.title,this.adress=o.adress,this.location=o.location,this.marker=null},ViewModel=function(){"use strict";var o=this;o.allLocations=[],o.filteredLocations=ko.observableArray([]),o.search=ko.observable(""),locations.forEach(function(e){o.allLocations.push(new Location(e))}),o.allLocations.forEach(function(o){function e(){null!==o.marker.getAnimation()?o.marker.getAnimation(null):(o.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){o.marker.setAnimation(null)},1400))}o.marker=new google.maps.Marker({map:map,position:o.location,title:o.title,animation:google.maps.Animation.DROP}),infoWindow=new google.maps.InfoWindow,o.marker.addListener("click",e),google.maps.event.addListener(o.marker,"click",function(){yelp(o.title,o.location.lat,o.location.lng,o.marker,o.adress)})}),o.list=function(o,e){google.maps.event.trigger(o.marker,"click")},o.allLocations.forEach(function(e){o.filteredLocations.push(e)}),o.filter=function(){o.filteredLocations([]),o.allLocations.forEach(function(e){e.marker.setVisible(!1),e.title.toLowerCase().indexOf(o.search().toLowerCase())>=0&&(e.marker.setVisible(!1),o.filteredLocations.push(e))}),o.filteredLocations().forEach(function(o){o.marker.setVisible(!0)})}},yelp=function(o,e,t,i,a){"use strict";function n(){return Math.floor(1e12*Math.random()).toString()}var s="http://api.yelp.com/v2/search",r="GET",l={oauth_consumer_key:"9qSE5baunEVztPs599-Xcg",oauth_token:"cMci0IX2rSc_IP-feuupAoJWa7jjKIJX",oauth_nonce:n(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",term:o,radius_filter:100,limit:1,location:a,cll:e+","+t},c="_kaJ3jISxoLvp1Wx3K553AW-WHM",u="M4RnfNHqi7zyQwFD-jCnAcuWXUQ",m=oauthSignature.generate(r,s,l,c,u);l.oauth_signature=m;var f={url:s,data:l,cache:!0,dataType:"jsonp",success:function(e){var t='<div class="info-window">';t+="<h4>"+o+"</h4>",t+=void 0!==e.businesses[0].rating_img_url?'<img class="rating-image" src="'+e.businesses[0].rating_img_url+'"></div>':"</div>",infoWindow.setContent(t),infoWindow.open(map,i)},error:function(){$("#errorMessage").removeClass("hide").addClass("present")}};$.ajax(f)};